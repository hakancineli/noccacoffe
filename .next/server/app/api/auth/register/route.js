"use strict";(()=>{var e={};e.id=2,e.ids=[2],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},4300:e=>{e.exports=require("buffer")},6113:e=>{e.exports=require("crypto")},2781:e=>{e.exports=require("stream")},3837:e=>{e.exports=require("util")},4191:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>x,originalPathname:()=>P,patchFetch:()=>b,requestAsyncStorage:()=>m,routeModule:()=>h,serverHooks:()=>f,staticGenerationAsyncStorage:()=>g,staticGenerationBailout:()=>k});var a={};r.r(a),r.d(a,{POST:()=>d});var s=r(884),i=r(6132),u=r(1040),n=r(5798),o=r(5764),l=r(6721),p=r.n(l),c=r(7542);async function d(e){try{let{email:t,password:r,firstName:a,lastName:s,phone:i,birthDate:u}=await e.json();if(!t||!r)return n.Z.json({error:"Email ve şifre zorunludur"},{status:400});let l=await c._.user.findUnique({where:{email:t}});if(l)return n.Z.json({error:"Bu e-posta adresi zaten kayıtlı"},{status:409});let d=await o.ZP.hash(r,12),h=await c._.user.create({data:{email:t,passwordHash:d,firstName:a||null,lastName:s||null,phone:i||null,birthDate:u?new Date(u):null},select:{id:!0,email:!0,firstName:!0,lastName:!0,phone:!0,birthDate:!0,createdAt:!0}});await c._.userPoints.create({data:{userId:h.id,points:0,tier:"BRONZE"}});let m=p().sign({userId:h.id,email:h.email},process.env.JWT_SECRET||"fallback-secret",{expiresIn:"7d"}),g=n.Z.json({message:"Kullanıcı başarıyla oluşturuldu",user:h,token:m});return g.cookies.set("auth-token",m,{httpOnly:!0,secure:!0,sameSite:"strict",maxAge:604800,path:"/"}),g}catch(e){return console.error("Registration error:",e),n.Z.json({error:"Kayıt sırasında bir hata oluştu"},{status:500})}}let h=new s.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/auth/register/route",pathname:"/api/auth/register",filename:"route",bundlePath:"app/api/auth/register/route"},resolvedPagePath:"/Users/hakancineli/CascadeProjects/starbucks-turkey-clone/src/app/api/auth/register/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:m,staticGenerationAsyncStorage:g,serverHooks:f,headerHooks:x,staticGenerationBailout:k}=h,P="/api/auth/register/route";function b(){return(0,u.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:g})}},7542:(e,t,r)=>{r.d(t,{_:()=>i});let a=require("@prisma/client"),s=globalThis,i=s.prisma??new a.PrismaClient}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[271,107,721,764],()=>r(4191));module.exports=a})();